# MetalSiteHunter

We offer an ensemble 3D deep convolution neural network to predict the metal binding sites. We consider protein structures to be three-dimensional images with voxels parameterized by atom biophysical properties. We exploit the strength of CNN architecture to detect spatially proximate features. These detectors of local biochemical interactions are then hierarchically composed into more intricate features capable of describing the complex and nonlinear phenomenon of molecular interaction. We finally used the features in an ensemble model to predict the metal-binding site. you can use google colab to repoduce the results or using this [web server](https://mohamad-lab.ai/metalsitehunter/ "MetalSiteHunter") for testing. 

![metal-site-prediction-data-pipeline](https://github.com/ClinicalAI/metal-site-hunter/blob/main/model_pipe_line.png)
## Data
We used MetalPDB database to collect the 3D structure of the protein metal binding sites. MetalPDB contains around 300,000 sites from more than 50,000 structures. We downloaded 243,600 metal-binding sites information for ten different metals namely Mg, Zn, Fe, Ca, Na, Mn, Cd, Cu, Sr, Ni and Co from MetalPDB database (downloaded in Jan 2021). We cleaned the PDB structures and removed the water and metal ions from the structures. The final cleaned PDB structures have been saved into the local machine for further analysis. As MetalPDB compiled all the binding sites of a single protein, some of the binding sites were identical structures that occurred in different domains of the same protein. We used CD-HIT to remove redundant binding sites with a sequence similarity of more than 90%. We found 20,972 of these structures are unique among total 243,600. We ended up choosing the top five metals (Fe, Zn, Mg, Ca and Na) with over 2,000 samples to build a robust model with enough training samples. Moreover, to build a training dataset for the non-metal binding site, we downloaded random PDBs from the RCSB PDB based on the list of all PDB provided at the PDB website. We developed a Python code to parse the PDB file to verify the selected file does not contain a metal. Then we used Fpocket to find pocket of the PDBs and rank them based on the Fpocket score. We added the pocket with the highest score to our non-metal binding site database. Using this approach, we build a non-metal binding site dataset with 3,000 pocket sites. 
We extracted 3D features using [HTMD](https://software.acellera.com/docs/latest/htmd/index.html) python package.  We used getVoxelDescriptors of HTMD package to build the 3D feature descriptors for each PDB file. For each pocket in our dataset we load the PDB structures and apply the prepareProteinForAtomtyping to remove non-protein atoms and add polar hydrogens. We then developed a Python code to calculate the center of the pocket by averaging the coordinations of all alpha-carbon available in the structure. We generated seven different type of voxel for each pocket namely, ‘hydrophobic’, ‘aromatic’, ‘hbond_acceptor’, ‘hbond_donor’, ‘positive_ionizable’, ‘negative_ionizable’ and ‘occupancies’. We removed those structures which HTMD couldn’t build 3D voxel for them from our dataset. Finally, we built 3D voxel structures for the structures available in our datasets.

## Codes
This project used Google Colab for processing, you can use the note-books in _Codes_ directory and run them on the Google Colab.
## Pre-Trained Models
Also there are set of pre-trained models that we used in our web server in the _Trained_models_ directory.
## Training Models

